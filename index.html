<html>
    <head>

    </head>
    <body>
        <h1>MediMoov !!!!</h1>
        <div id="maincontent">

        </div>
        <div id="form-message">

        </div>
            <div class="p-2 p-md-0 bg-light bg-md-white max-width">
              <div class="contact-form-content">
                <div class="row">
                  <div class="col-12 mt-1">
                    <input id="inputname" name="name" type="text" class="form-control" placeholder="Nom *">
                  </div>
                  <div class="col-12 mt-1">
                    <input id="inputemail" name="email" type="email" class="form-control" placeholder="E-mail *">
                  </div>
                </div>
                <textarea id="inputmessage" name="message" class="form-control mt-1" rows="8" placeholder="Message *"></textarea>
                
                <div class="text-right">
                  <button class="btn btn-primary submit g-recaptcha" id="btn-submit-mmform">
                    <span class="txt">Envoyer</span>
                    <i class="fas fa-spinner spinner" style="display:none"></i>
                  </button>
                </div>
                  <div class="small text-primary">
                      * champs requis
                  </div>
              </div>
            </div>
    </body>
</html>

<script>
var url = "/medimoovform"
document.getElementById("btn-submit-mmform").onclick = function() {
    let name = document.getElementById("inputname").value ;
    let email = document.getElementById("inputemail").value ;
    let msg = document.getElementById("inputmessage").value ;
    console.log(`name: ${name} email: ${email} msg:${msg}`);
    let main = document.getElementById("form-message");
    if(name && email && msg)
    {
      fetch(url, {    method:'POST', 
                      body: JSON.stringify({
                          email: email,
                          name: name,
                          msg: msg
                      }),
                      headers:{'Content-Type': 'application/json'}, 
                      mode:"cors", 
                      cache:'default'}).then(
        function(response){
            response.text().then(function(data){
                let responsebody = document.createElement("div");
                responsebody.appendChild(document.createTextNode(data));
                main.innerHTML = "";
                main.appendChild(responsebody);
            })
        }
      )  
    }
    else 
    {
      main.innerHTML = "";
      let formverification = document.createElement("div");
      if(!name) 
      {
        formverification.appendChild(document.createTextNode("please specify name. "));
      }
      if(!msg)
      {
        formverification.appendChild(document.createTextNode("please specify message. "));
      }
      if(!email)
      {
        formverification.appendChild(document.createTextNode("please specify email. "));
      }
      else
      {
        const re = /^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;
        if(!re.test(String(email).toLowerCase())) formverification.appendChild(document.createTextNode("not valid email. "));
      }
      main.appendChild(formverification);
    }
   }
</script>